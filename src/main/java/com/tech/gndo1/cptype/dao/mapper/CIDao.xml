<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tech.gndo1.cptype.dao.CIDao">
	<insert id="cpInsert">
		INSERT INTO ACCOMMODATION_INFO(ACC_NUM,ACC_TEL,ACC_INFO,ACC_SERKEYWORD,ACC_MAP,ACC_NAME,ACC_LOCATION,ACC_LA,ACC_LO,CPY_NUM,ACC_DETAILMAP)
		 VALUES(ACCOMMODATION_INFO_SEQ.NEXTVAL,#{param2},#{param3},#{param4},#{param5},#{param1},#{param6},#{param7},#{param8},#{param9},#{param10})
	</insert>
	<insert id="cpimginsert">
		INSERT INTO ACCOMMODATION_IMG(ACCI_NUM,ACC_NUM,ACCI_IMG,ACCI_AFTERIMG)
		VALUES(ACCOMMODATION_IMG_SEQ.NEXTVAL,#{param2},#{param1},#{param3})
	</insert>
<!-- 	<select id="accinfo" resultType="com.tech.gndo1.cptype.dto.CpTypeDto"> -->
<!-- 		SELECT * FROM ACCOMMODATION_INFO -->
<!-- 	</select> -->
	<select id="selacc_num" resultType="Integer">
		SELECT MAX(ACC_NUM) FROM ACCOMMODATION_INFO  <!--WHERE CPY_NUM (paramê°’) -->
	</select>
	<insert id="rtInsert">
		INSERT INTO ROOMTYPE(RT_NUM,RT_RMNAME,
		RT_RMCOUNT,RT_RPEOPLE,RT_PRICE,RT_INFO,RT_IN,RT_OUT,ACC_NUM)
		 VALUES(ROOMTYPE_SEQ.NEXTVAL,#{param1},#{param2},#{param3},#{param4},#{param5},#{param6},#{param7},#{param8})
	</insert>
	<insert id="rtimginsert">
		INSERT INTO ROOMTYPE_IMG(RTI_NUM,RTI_IMG,RT_NUM,RTI_AFTERIMG)
		 VALUES(ROOMTYPE_IMG_SEQ.NEXTVAL,#{param1},#{param2},#{param3})
	</insert>
	<select id="selrt_num" resultType="Integer">
		SELECT MAX(RT_NUM) FROM ROOMTYPE
	</select>
	<select id="accsel" resultType="Integer">
		SELECT ACC_NUM FROM ACCOMMODATION_INFO WHERE CPY_NUM=#{param1}
	</select>
	<select id="cptype" resultType="com.tech.gndo1.cptype.dto.Accommodation_infoDto">
		SELECT * FROM ACCOMMODATION_INFO WHERE ACC_NUM=#{param1}
	</select>
	<select id="cptypesel" resultType="com.tech.gndo1.cptype.dto.Accommodation_infoDto">
		SELECT * FROM ACCOMMODATION_INFO WHERE ACC_NUM=#{param1}
	</select>
	<select id="htsel" resultType="com.tech.gndo1.roomtype.dto.RoomTypeDto">
		SELECT * FROM ROOMTYPE
	</select>
	<select id="acccnt" resultType="Integer">
		SELECT COUNT(ACC_NUM) FROM ACCOMMODATION_INFO WHERE CPY_NUM=#{param1}
	</select>
	<select id="rtnumsel" resultType="com.tech.gndo1.roomtype.dto.RoomTypeDto">
		SELECT RT_NUM FROM ROOMTYPE WHERE ACC_NUM=#{param1}
	</select>
	<delete id="rtdel">
		DELETE FROM ROOMTYPE WHERE RT_NUM=#{param1}
	</delete>
	<delete id="rtidel">
		DELETE FROM ROOMTYPE_IMG WHERE RT_NUM=#{param1}
	</delete>
	
	<resultMap type="com.tech.gndo1.roomtype.dto.RoomTypeimgDto" id="roomtypeimg">
		<result property="rti_num" column="RTI_NUM" />
		<result property="rt_num" column="RT_NUM" />
		<result property="rti_img" column="RTI_IMG" />
		<result property="rti_afterimg" column="RTI_AFTERIMG" />
	</resultMap>
	<resultMap type="com.tech.gndo1.roomtype.dto.RoomTypeDto" id="roomtype">
		<result property="rt_num" column="RT_NUM"/>
		<result property="acc_num" column="ACC_NUM"/>
		<result property="rt_rmname" column="RT_RMNAME"/>
		<result property="rt_rmcount" column="RT_RMCOUNT"/>
		<result property="rt_rpeople" column="RT_RPEOPLE"/>
		<result property="rt_price" column="RT_PRICE"/>
		<result property="rt_info" column="RT_INFO"/>
		<result property="rt_in" column="RT_IN"/>
		<result property="rt_out" column="RT_OUT"/>
	<collection property="rti" resultMap="roomtypeimg"/>
	</resultMap>
		<select id="accroomselect" resultType="com.tech.gndo1.roomtype.dto.RoomTypeDto" resultMap="roomtype">
			SELECT R.RT_NUM, R.RT_RMNAME, R.RT_RMCOUNT,R.RT_RPEOPLE,R.RT_PRICE,R.RT_INFO,R.RT_IN,R.RT_OUT,MIN(I.RTI_AFTERIMG) RTI_IMG,COUNT(I.RTI_AFTERIMG) RTI_AFTERIMG FROM ROOMTYPE R, ROOMTYPE_IMG I
			WHERE R.RT_NUM=I.RT_NUM AND R.ACC_NUM=#{PARAM1}
			GROUP BY R.RT_NUM, R.RT_RMNAME, R.RT_RMCOUNT,R.RT_RPEOPLE,R.RT_PRICE,R.RT_INFO,R.RT_IN,R.RT_OUT
		</select>
<!-- 	<select id="rlist" resultType="com.tech.gndo1.roomtype.dto.RoomTypeDto"> -->
<!-- 		SELECT RT_NUM,ACC_NUM,RT_RMNAME,RT_RMCOUNT, -->
<!-- 		RT_RPEOPLE,RT_PRICE,RT_INFO,RT_IN,RT_OUT -->
<!-- 		 FROM ROOMTYPE -->
<!-- 	</select> -->
</mapper>